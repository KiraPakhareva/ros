# Реализация цикла обучения

Цикл обучения-это тот, который повторяет цикл обучения, описанный выше. Именно там выполняется обучающий код. Он в основном состоит из двух основных петель: • Сначала у нас есть цикл с количеством эпизодов, которые робот будет протестирован. Каждый эпизод означает количество раз, которое мы позволим роботу попытаться решить эту задачу. • Во-вторых, у нас есть цикл с количеством шагов . Для каждого эпизода мы позволяем роботу выполнить заданное количество действий, количество шагов, количество петель в цикле усиления. Если робот выполняет все шаги, мы считаем, что он не решил задачу и, следовательно, новый эпизод должен начаться.

**Количество циклов эпизодов**

Все начинается с кода:

```text
for x in range(nepisodes):
```

Помните, что число эпизодов является параметром из файла конфигурации. Цикл в основном делает это, чтобы сбросить среду \(инициализировать робота\), так что новая пробная версия может начать с исходного положения. Он также получает начальное наблюдение состояния, требуемое алгоритмом обучения для генерации первого действия.

```text
observation = env.reset()
```

Количество шагов цикла

Все начинается с кода:

```text
for i in range(nsteps):
```

и в основном то, что он делает, это: 

Научит алгоритм обучения выбрать действие на основе текущего состояния

```text
action = qlearn.chooseAction(state)
```

Выполнит действие в среде

```text
observation, reward, done, info = env.step(action)
```

Получит новое состояние после выполнения действия

```text
	nextState = ''.join(map(str, observation))
```

Извлечет уроки из этого результата

```text
qlearn.learn(state, action, reward, nextState)
```

И это все. Вот так просто. Циклы будут повторяться на основе значений параметров, и как только они закончатся, файлы журнала будут генерироваться в каталоге training\_results.

![](../.gitbook/assets/image%20%284%29.png)



